<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>我的拍卖</title>
    <link rel="stylesheet" type="text/css" href="../static/CSS/reset.css">
    <link rel="stylesheet" href="../static/CSS/my_auction_four.css">
      <script type="text/javascript" src="../static/JS/jquery-1.12.4.min.js"></script>

</head>
<body >
<div class="header_con">
    <div class="header">
        <div class="welcome fl">{{ username.user_name }}欢迎来到海马二手商城!</div>
        <div class="fr">
            <div class="login_btn fl">
                <a href="/login/?href=/my_auction/" target="_blank">登录</a>
                <span>|</span>
                <a href="/register/">注册</a>
            </div>
            <div class="user_link fl">
                <span>|</span>
                <a href="/haima/">首页</a>
                <span>|</span>
                <a href="/user_center/">用户中心</a>
                <span>|</span>
                <a href="" id="my_order">我的订单</a>
                <span>|</span>
                <a href="" id="my_order">留言 <img src="../static/Images/message.png" alt="" width="10" height="10"></a>
            </div>
        </div>
    </div>
</div>
<div class="navbar_con">
    <div class="navbar">
        <h1 class="fl">商品分类</h1>
        <ul class="navlist fl">
            <li><a href="">首页</a></li>
            <li><a href="">发布闲置</a></li>
            <li><a href="">拍卖</a></li>
            <li><a href="">二手估价</a></li>
            <li><a href="">我的闲置</a></li>
        </ul>
    </div>
</div>
<div class="Navigation_information">
    <div id="auction_Navigation">
        <a href="/release_auction/"><button id="release_auction">发布拍卖</button></a>
        <a href="/auction_index/"><button id="now_auction">正在拍卖</button></a>
        <a href="/history_auction/"><button id="histroy_auction">历史拍卖</button></a>
    </div>
    <div id="auction_classification">
        <div>拍卖分类：</div>
        <div><a href="">手机</a></div>
        <div><a href="">相机</a></div>
        <div><a href="">电脑</a></div>
        <div><a href="">外设</a></div>
    </div>

</div>
<hr>
<div id="auction_select">
    <div>
    <a href="/my_auction_one/"><button id="auction_one" value="one">我发布的</button></a>
    <a href="/my_auction_two/"><button id="auction_two" value="two">我拍卖的</button></a>

    <a href="/my_auction_four/"><button id="auction_four" value="four">我竞拍的</button></a>
    </div>
    <div>
        <span style="font-size: 14px; font-weight: bolder">商品状态选择:</span>
    <select name="" id="goods_state" onchange="f1(this)">
        <option value="0" >竞拍中</option>
        <option value="1">竞拍失败</option>
        <option value="2">竞拍成功</option>
        <option value="3">付款失败</option>
        <option value="4">收货确认</option>
        <option value="5">历史成交订单</option>
    </select>
        </div>
</div>
<div id="select_one">
{% for i in list1%}
  <div id="four">
        <div>
            <img src={{ i.goods.auction_goods_imgurl }} alt="" height="360px" width="400px">
        </div>
         <div id="auction_goods_desc">
             <div id="title" style="font-size:25px">
                {{ i.goods.auction_goods_title }}
             </div>
             <br>
             <div id="auction_messige">
                <div id="auction_messige_desc" >
                    <div>开始时间：<span id="acution_goods_start_time">{{ i.attribute.start_date }}</span></div>
                    <br>
                    <div>结束时间：<span id="acution_goods_start_time">{{ i.attribute.end_date }}</span></div>
                    <br>
                    <div>开始价格：<span id="acution_goods_start_price">{{ i.record.auction_goods_oldprice }}</span></div>
                    <br>
                    <div>我的加价：<span id="auction_goods_my_price">{{ i.record.auction_goods_premium }}</span></div>
                    <br>
                    <div>加价后价格：<span id="acution_goods_start_time">{{ i.record.auction_goods_price }}</span></div>
                    <br>
                    <div>竞拍状态：<span id="acution_goods_start_time">{{ i.state }}</span></div>
                    <br>
                </div>
             </div>
         </div>
    </div>
{% endfor %}
</div>
<div id="select_two">
{% for i in list2 %}
  <div id="four">
        <div>
            <img src={{ i.goods.auction_goods_imgurl }} alt="" height="360px" width="400px">
        </div>
         <div id="auction_goods_desc">
             <div id="title" style="font-size:25px">
                {{ i.goods.auction_goods_title }}
             </div>
             <br>
             <div id="auction_messige">
                <div id="auction_messige_desc" >
                    <div>开始时间：<span id="acution_goods_start_time">{{ i.attribute.start_date }}</span></div>
                    <br>
                    <div>结束时间：<span id="acution_goods_start_time">{{ i.attribute.end_date }}</span></div>
                    <br>
                    <div>开始价格：<span id="acution_goods_start_time">{{ i.record.auction_goods_oldprice }}</span></div>
                    <br>
                    <div>我的加价：<span id="auction_goods_floorprice">{{ i.record.auction_goods_premium }}</span></div>
                    <br>
                    <div>加价后价格：<span id="acution_goods_start_time">{{ i.record.auction_goods_price }}</span></div>
                    <br>
                    <div>竞拍状态：<span id="acution_goods_start_time">{{ i.state }}</span></div>
                    <br>

                </div>
             </div>
         </div>
    </div>
{% endfor %}
</div>
<div id="select_three">
{% for i in list3 %}
  <div id="four">
        <div>
            <img src={{ i.goods.auction_goods_imgurl }} alt="" height="360px" width="400px">
        </div>
         <div id="auction_goods_desc">
             <div id="title" style="font-size:25px">
                {{ i.goods.auction_goods_title }}
             </div>
             <br>
             <div id="auction_messige">
                <div id="auction_messige_desc" >

                    <div>竞拍成功时间：<span id="acution_goods_start_time">{{ i.order.auction_goods_date }}</span></div>
                    <br>
                    <div>开始价格：<span id="acution_goods_start_time">{{ i.record.auction_goods_oldprice }}</span></div>
                    <br>
                    <div>我的加价：<span id="auction_goods_floorprice">{{ i.record.auction_goods_premium }}</span></div>
                    <br>
                    <div>加价后价格：<span id="acution_goods_start_time">{{ i.record.auction_goods_price }}</span></div>
                    <br>
                    <div>竞拍状态：<span id="acution_goods_start_time">{{ i.state }}</span></div>
                    <br>
                   <div>
                       <button id="pay_money" onclick="pay(this)" value ={{ i.order.auction_order_id}}>
                           付款
                       </button>
                   </div>
                </div>
             </div>
         </div>
    </div>
{% endfor %}
</div>
<div id="select_five">
{% for i in list5 %}
  <div id="four">
        <div>
            <img src={{ i.goods.auction_goods_imgurl }} alt="" height="360px" width="400px">
        </div>
         <div id="auction_goods_desc">
             <div id="title" style="font-size:25px">
                {{ i.goods.auction_goods_title }}
             </div>
             <br>
             <div id="auction_messige">
                <div id="auction_messige_desc" >
                    <div>订单号：<span id="acution_goods_start_time">{{ i.order.auction_order_id }}</span></div>
                    <br>
                    <div>竞拍成功时间：<span id="acution_goods_start_time">{{ i.order.auction_order_date }}</span></div>
                    <br>
                    <div>支付日期：<span id="acution_goods_start_time">{{ i.ordr.pay_money_date }}</span></div>
                    <br>
                    <div>支付金额：<span id="auction_goods_floorprice">{{ i.order.auction_order_fianl_price }}</span></div>
                    <br>
                    <div>卖家发货状态：<span id="acution_goods_start_time">{{ i.state }}</span></div>
                    <br>

                   <div>
                       <button  id="confirm_goods"  onclick="confirm_goods(this)" value={{ i.order.auction_order_id }}>确认收货</button>
                   </div>
                </div>
             </div>
         </div>
    </div>
{% endfor %}
</div>
<div id="select_six">
{% for i in list6 %}
  <div id="four">
        <div>
            <img src={{ i.goods.auction_goods_imgurl }} alt="" height="360px" width="400px">
        </div>
         <div id="auction_goods_desc">
             <div id="title" style="font-size:25px">
                {{ i.goods.auction_goods_title }}
             </div>
             <br>
             <div id="auction_messige">
                <div id="auction_messige_desc" >
                    <div>订单号：<span id="acution_goods_start_time">{{ i.order.auction_order_id }}</span></div>
                    <br>
                    <div>订单生成时间：<span id="acution_goods_start_time">{{ i.order.auction_order_date }}</span></div>
                    <br>
                    <div>交易成功时间：<span id="acution_goods_start_time">{{ i.order.order_success_date }}</span></div>
                    <br>
                    <div>订单金额：<span id="auction_goods_floorprice">{{ i.order.auction_order_fianl_price }}</span></div>
                    <br>

                </div>
             </div>
         </div>
    </div>
{% endfor %}
</div>
<div id="info_message">
    <span id="info">您已经收到货</span>
    <span id="goods_order_id" style="display: none" >0</span>
    <br>
    <div id="button">
    <button id="ok">确认</button>
    <button id="no">返回</button>
    </div>
</div>


<div id="pay_message">
    <button id="shutdown">关闭</button>
    <span id="goods_order_id" style="display: none">0</span>
    <br>
   <span>请输入支付密码 <input type="text" maxlength="6" id="pay_password"></span>
    <br>
    <button id="pay_ok">确定</button>
    <span id="pay_error" style="display: none;color: red"></span>
</div>
</body>
<script>
    $("#ok").click(function () {
        order_id=$("#goods_order_id").text();
        $.post("/confirm_auction_goods/"
        ,
            {
                "order_id":order_id
            }
            ,function (data) {

            }
            ,'json')
    });

$("#no").click(function () {
      $("#info_message").hide()
});
      function confirm_goods(obj) {
        id=obj.value
        document.getElementById("goods_order_id").innerText=id;
        $("#info_message").show()
    }



    $("#pay_ok").click(function () {
        order_id=$("#order_id").text();
        pay_password=$("#pay_password").val();
        $.post("/pay_auction_money/"
        ,
            {
                "order_id":order_id,
                "pay_password":pay_password,

            }
            ,function (data) {
            switch (data.msg)
            {
                case"no_pay_password":
                    $('#pay_error').html(function () {
                            document.getElementById('pay_error').style.display='block';
                            document.getElementById('pay_error').innerText = "请输入支付密码";
                            });
                        break;
                case "pay_password_length_error":
                           $('#pay_error').html(function () {
                               document.getElementById('pay_error').style.display='block'
                            document.getElementById('pay_error').innerText = "密码长度不能少于六位数";
                            });
                        break;
                case "pay_password_error":
                           $('#pay_error').html(function () {
                               document.getElementById('pay_error').style.display='block'
                            document.getElementById('pay_error').innerText = "支付密码错误";
                            });
                        break;
                case "money_less_error":
                           $('#pay_error').html(function () {
                               document.getElementById('pay_error').style.display='block'
                            document.getElementById('pay_error').innerText = "账户余额不足";
                            });
                        break;
                case "pay_ok":
                           location.href = '/pay_auction_money_ok/'
                        break;
            }

            }
           ,'json'
        )

    })

    {#将那个订单id传到那个支付密码的界面#}
      function pay(obj) {
        order_id=obj.value
        document.getElementById("order_id").innerText=order_id;
        $("#pay_message").show()
    }
 function f1(obj) {
       if(obj.value==0)
       {
           f2()
       }
       else if(obj.value==1)
       {
         f3()
       }
         else if(obj.value==2)
       {
         f4()
       }
           else if(obj.value==3)
       {
         f5()
       }
           else if(obj.value==4)
       {
         f6()
       }
        else if(obj.value==5)
       {
         f7()
       }
    }
    function f2() {
        $("#select_one").show()
        $("#select_two").hide()
        $("#select_three").hide();
       $("#select_four").hide();
       $("#select_five").hide();
       $("#select_six").hide();
    }

    function f3(){
          $("#select_one").hide();
           $("#select_two").show();
           $("#select_three").hide();
           $("#select_four").hide();
           $("#select_five").hide();
             $("#select_six").hide();
    }
    function f4()
    {
          $("#select_one").hide();
           $("#select_two").hide();
           $("#select_three").show();
           $("#select_four").hide();
           $("#select_five").hide();
             $("#select_six").hide();
    }

    function f5(){
          $("#select_one").hide();
           $("#select_two").hide();
           $("#select_three").hide();
           $("#select_four").show();
           $("#select_five").hide();
          $("#select_six").hide();
    }
        function f6(){
          $("#select_one").hide();
           $("#select_two").hide();
           $("#select_three").hide();
           $("#select_four").hide();
           $("#select_five").show();
           $("#select_six").hide();

    }
    function f7(){
          $("#select_one").hide();
           $("#select_two").hide();
           $("#select_three").hide();
           $("#select_four").hide();
           $("#select_five").hide();
           $("#select_six").show();

    }
    window.onload=function () {
        x=$("#goods_state").val()
        if(x==0) {f2()}
        if(x==1) {f3()}
        if(x==2) {f4()}
        if(x==3) {f5()}
        if(x==4) {f6()}
         if(x==5) {f7()}
    }
    $("#shutdown").click(function () {
         $("#pay_message").hide()
    })

</script>
</html>